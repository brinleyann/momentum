<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Momentum</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>

body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial;
    background: #f8fafc;
    color: #0f172a;
    margin: 0;
}

.header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 40px;
}

.logo {
    font-size: 20px;
    font-weight: 600;
}

.auth-buttons button {
    margin-left: 10px;
}

.container {
    max-width: 500px;
    margin: 80px auto;
    text-align: center;
}

h1 {
    font-size: 42px;
    margin-bottom: 10px;
}

.subtitle {
    color: #64748b;
    margin-bottom: 40px;
}

button {
    background: #6366f1;
    color: white;
    border: none;
    padding: 14px 22px;
    border-radius: 8px;
    font-size: 16px;
    cursor: pointer;
}

button:hover {
    opacity: .9;
}

.streak {
    margin-top: 25px;
    font-size: 18px;
}

.footer {
    position: fixed;
    bottom: 10px;
    width: 100%;
    text-align: center;
    font-size: 14px;
}

.footer a {
    color: #94a3b8;
    text-decoration: none;
}

.footer a:hover {
    color: #64748b;
}

</style>
</head>

<body>

<div class="header">

<div class="logo">
Momentum
</div>

<div class="auth-buttons" id="authButtons">
<button onclick="signUp()">Sign up</button>
<button onclick="logIn()">Log in</button>
</div>

</div>


<div class="container">

<h1>Momentum</h1>

<div class="subtitle">
Build consistency. One day at a time.
</div>

<button onclick="checkIn()" id="checkInBtn">
I showed up today
</button>

<div class="streak">
Current streak: <span id="streakNumber">0</span>
</div>

</div>


<div class="footer">
<a href="https://buymeacoffee.com/YOURNAME" target="_blank">
Buy me a coffee
</a>
</div>


<script>

// PASTE YOUR SUPABASE INFO HERE
const SUPABASE_URL = "https://btmncubexcqpuonfxrfe.supabase.co"
const SUPABASE_KEY = "sb_publishable_iQ_99G3PwZgJ-mAfDaMz2g_ARdC7XfL"

const supabase = window.supabase.createClient(
SUPABASE_URL,
SUPABASE_KEY
)

let user = null


async function signUp(){

const email = prompt("Email:")
const password = prompt("Password:")

if(!email || !password) return

const { error } = await supabase.auth.signUp({
email,
password
})

if(error){
alert(error.message)
}else{
alert("Check your email to confirm.")
}

}


async function logIn(){

const email = prompt("Email:")
const password = prompt("Password:")

if(!email || !password) return

const { data, error } = await supabase.auth.signInWithPassword({
email,
password
})

if(error){
alert(error.message)
}else{
user = data.user
loadStreak()
}

}


async function loadStreak(){

const { data } = await supabase
.from("profiles")
.select("streak")
.eq("id", user.id)
.single()

if(data){
document.getElementById("streakNumber").innerText =
data.streak
}

}


async function checkIn(){

if(!user){
alert("Log in first")
return
}

const { data } = await supabase
.from("profiles")
.select("streak")
.eq("id", user.id)
.single()

let newStreak = (data?.streak || 0) + 1

await supabase
.from("profiles")
.update({
streak: newStreak
})
.eq("id", user.id)

document.getElementById("streakNumber").innerText =
newStreak

}


// auto login
supabase.auth.getUser().then(({data})=>{
if(data.user){
user = data.user
loadStreak()
}
})

</script>

</body>
</html>
